imports: !import
  - {from: pyro, import: distributions as dist}
  - {from: pyrofit.lensing.utils, import: get_meshgrid}
  - {from: pyrofit.lensing.new.model, import: LensingModelBase}
  - {from: pyrofit.lensing.new.lenses, import: [SPLELens, ExternalShear]}
  - {from: pyrofit.lensing.new.sources, import: UnitPriorWindowedGPSource}
defs:
  XY: &XY !py:get_meshgrid [0.0125, 400, 400]
  mask: &mask !tensor:bool [!npy /Users/kosio/Projects/Scientific/MLens/pyrofit_lensing/yaml/windowed_gp/mock/mask_400x400_sigma_n=3.0.npy]
conditioning:
  image: !tensor [!npy /Users/kosio/Projects/Scientific/MLens/pyrofit_lensing/yaml/windowed_gp/mock/obs_400x400_sigma_n=3.0.npy]
model: !Stochastic
  - !py:LensingModelBase
    __args: *XY
    alphas:
      ext: !Stochastic:ext
        - !py:ExternalShear {__args: *XY}
        - gamma_1: 0.0070
          gamma_2: 0.0095
      main: !Stochastic:main
        - !py:SPLELens {__args: *XY}
        - {slope: 2.1, phi: -0.4564, q: 0.8310, r_ein: 1.4897, x: -0.2665, y: 0.0999}
    sources:
      src: !Stochastic:src
        - !py:UnitPriorWindowedGPSource {mask: *mask}
        - sigma: 0.01
          alpha: !py:dist.Uniform [0., 100.]
          theta: !InfiniteSampler
            init: !py:torch.zeros [400, 400]
            mask: *mask
            expand_by: [400, 400]
  - sigma_stat: 3.
    model_err: 0.
